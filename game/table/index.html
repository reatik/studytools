<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>每日作业情况记录</title>
    <style>
        * {
            box-sizing: border-box;
        }
        body {
            font-family: 'Microsoft YaHei', sans-serif;
            margin: 0;
            padding: 10px;
            background-color: #f5f5f5;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            -webkit-text-size-adjust: 100%;
        }
        .container {
            width: 100%;
            margin: 0 auto;
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 1px 5px rgba(0,0,0,0.05);
            flex: 1;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        .header-controls {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-bottom: 15px;
        }
        .classroom-selector {
            display: flex;
            gap: 8px;
            overflow-x: auto;
            padding-bottom: 5px;
            -webkit-overflow-scrolling: touch;
        }
        .classroom-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            white-space: nowrap;
            font-size: 0.9rem;
        }
        .classroom-btn.active {
            color: white;
        }
        .classroom-89-btn {
            background-color: #E3F2FD;
            color: #1976D2;
        }
        .classroom-89-btn.active {
            background-color: #1976D2;
        }
        .classroom-137-btn {
            background-color: #F3E5F5;
            color: #9C27B0;
        }
        .classroom-137-btn.active {
            background-color: #9C27B0;
        }
        .date-picker {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.9rem;
            width: 100%;
        }
        .classroom {
            margin-bottom: 20px;
            display: none;
        }
        .classroom.active {
            display: block;
        }
        .classroom h2 {
            color: white;
            padding: 8px;
            border-radius: 4px;
            margin-top: 0;
            text-align: center;
            font-size: 1.1rem;
        }
        .classroom-89 h2 {
            background-color: #1976D2;
        }
        .classroom-137 h2 {
            background-color: #9C27B0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            font-size: 0.85rem;
        }
        th, td {
            padding: 6px 8px;
            border: 1px solid #ddd;
            position: relative;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
            font-size: 0.9rem;
        }
        td.name-cell {
            font-weight: bold;
            white-space: nowrap;
        }
        tr:hover {
            background-color: #f5f5f5;
        }
        .interactive-cell {
            cursor: pointer;
            transition: background-color 0.3s;
            min-width: 35px;
            height: 35px;
            position: relative;
        }
        .interactive-cell.checked {
            background-color: #e8f5e9;
        }
        .interactive-cell.checked::after {
            content: "✓";
            color: #4CAF50;
            font-size: 16px;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .interactive-cell.has-note {
            background-color: #fff3e0;
        }
        .interactive-cell.has-note::before {
            content: "✎";
            color: #FF9800;
            font-size: 10px;
            position: absolute;
            top: 2px;
            right: 2px;
        }
        .action-buttons {
            display: flex;
            gap: 8px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }
        .action-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            color: white;
            flex: 1;
            text-align: center;
            font-size: 0.9rem;
        }
        .clear-today-btn {
            background-color: #ff7043;
        }
        .clear-today-btn:hover {
            background-color: #f4511e;
        }
        .clear-all-btn {
            background-color: #e53935;
        }
        .clear-all-btn:hover {
            background-color: #c62828;
        }
        .note-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 15px;
        }
        .note-content {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            width: 100%;
            max-width: 400px;
        }
        .note-textarea {
            width: 100%;
            height: 120px;
            margin: 10px 0;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: none;
            font-size: 0.9rem;
        }
        .note-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 8px;
        }
        .note-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
        }
        .note-save {
            background-color: #4CAF50;
            color: white;
        }
        .note-cancel {
            background-color: #f44336;
            color: white;
        }
        .custom-alert {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }
        .custom-alert-content {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            width: 80%;
            max-width: 300px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        .custom-alert-title {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }
        .custom-alert-message {
            font-size: 0.95rem;
            margin-bottom: 20px;
            color: #555;
            line-height: 1.4;
        }
        .custom-alert-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        .custom-alert-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            min-width: 80px;
        }
        .custom-alert-confirm {
            background-color: #1976D2;
            color: white;
        }
        .custom-alert-cancel {
            background-color: #f5f5f5;
            color: #333;
        }

        @media (min-width: 768px) {
            .container {
                max-width: 900px;
                padding: 20px;
            }
            .header-controls {
                flex-direction: row;
                justify-content: space-between;
                align-items: center;
            }
            .date-picker {
                width: auto;
            }
            h1 {
                font-size: 1.5rem;
            }
            .classroom h2 {
                font-size: 1.3rem;
            }
            th, td {
                padding: 8px 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header-controls">
            <div class="classroom-selector">
                <button class="classroom-btn classroom-89-btn active" onclick="showClassroom('89')">89号教室</button>
                <button class="classroom-btn classroom-137-btn" onclick="showClassroom('137')">137号教室</button>
            </div>
            <input type="date" id="datePicker" class="date-picker" onchange="loadDailyRecord()">
        </div>
        
        <h1>每日作业情况记录</h1>
        
        <div class="classroom classroom-89 active">
            <h2>89号教室</h2>
            <div style="overflow-x: auto;">
                <table>
                    <thead>
                        <tr>
                            <th>姓名</th>
                            <th>语文</th>
                            <th>数学</th>
                            <th>英语</th>
                            <th>学校</th>
                            <th>自己</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="name-cell">濮谨丰</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                        <tr>
                            <td class="name-cell">张佳倪</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                        <tr>
                            <td class="name-cell">易杜谦</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                        <tr>
                            <td class="name-cell">陈曜扬</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                        <tr>
                            <td class="name-cell">韩依依</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                        <tr>
                            <td class="name-cell">黄子芮</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                        <tr>
                            <td class="name-cell">周牧坤</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                        <tr>
                            <td class="name-cell">许晨熙</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                        <tr>
                            <td class="name-cell">阚宇杰</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                        <tr>
                            <td class="name-cell">刘宗淇</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                        <tr>
                            <td class="name-cell">韩壹</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                        <tr>
                            <td class="name-cell">季俊澄</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="classroom classroom-137">
            <h2>137号教室</h2>
            <div style="overflow-x: auto;">
                <table>
                    <thead>
                        <tr>
                            <th>姓名</th>
                            <th>语文</th>
                            <th>数学</th>
                            <th>英语</th>
                            <th>学校</th>
                            <th>自己</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="name-cell">叶子涵</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                        <tr>
                            <td class="name-cell">倪晨茜</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                        <tr>
                            <td class="name-cell">何梓惜</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                        <tr>
                            <td class="name-cell">倪梓淇</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                        <tr>
                            <td class="name-cell">倪梓悦</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                        <tr>
                            <td class="name-cell">赵雨乐</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                        <tr>
                            <td class="name-cell">申翊菡</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                        <tr>
                            <td class="name-cell">冯熙晴</td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                            <td class="interactive-cell" onclick="handleCellClick(this)" ontouchstart="handleTouchStart(this)" ontouchend="handleTouchEnd(this)"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="action-buttons">
            <button class="action-btn clear-today-btn" onclick="clearTodayRecord()">清除本日记录</button>
            <button class="action-btn clear-all-btn" onclick="clearAllRecords()">清除所有记录</button>
        </div>
    </div>

    <div class="note-modal" id="noteModal">
        <div class="note-content">
            <h3>添加备注</h3>
            <textarea class="note-textarea" id="noteTextarea" placeholder="请输入备注内容..."></textarea>
            <div class="note-buttons">
                <button class="note-btn note-cancel" onclick="closeNoteModal()">取消</button>
                <button class="note-btn note-save" onclick="saveNote()">保存</button>
            </div>
        </div>
    </div>

    <div class="custom-alert" id="customAlert">
        <div class="custom-alert-content">
            <div class="custom-alert-title" id="alertTitle">提示</div>
            <div class="custom-alert-message" id="alertMessage"></div>
            <div class="custom-alert-buttons">
                <button class="custom-alert-btn custom-alert-confirm" id="alertConfirmBtn">确定</button>
                <button class="custom-alert-btn custom-alert-cancel" id="alertCancelBtn">取消</button>
            </div>
        </div>
    </div>

    <script>
        const STORAGE_KEY = 'dailyHomeworkRecords';
        let currentCell = null;
        let longPressTimer = null;
        const LONG_PRESS_DURATION = 500;
        
        function showClassroom(classroom) {
            document.querySelectorAll('.classroom-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (classroom === '89') {
                document.querySelector('.classroom-89-btn').classList.add('active');
            } else {
                document.querySelector('.classroom-137-btn').classList.add('active');
            }
            
            document.querySelectorAll('.classroom').forEach(cls => {
                cls.classList.remove('active');
            });
            
            document.querySelector(`.classroom-${classroom}`).classList.add('active');
        }

        function handleCellClick(cell) {
            if (longPressTimer) {
                clearTimeout(longPressTimer);
                longPressTimer = null;
                return;
            }
            toggleCell(cell);
        }

        function handleTouchStart(cell) {
            longPressTimer = setTimeout(() => {
                openNoteModal(cell);
                longPressTimer = null;
            }, LONG_PRESS_DURATION);
        }

        function handleTouchEnd() {
            if (longPressTimer) {
                clearTimeout(longPressTimer);
                longPressTimer = null;
            }
        }

        function toggleCell(cell) {
            cell.classList.toggle('checked');
            saveDailyRecord();
        }

        function openNoteModal(cell) {
            currentCell = cell;
            const modal = document.getElementById('noteModal');
            const textarea = document.getElementById('noteTextarea');
            
            const datePicker = document.getElementById('datePicker');
            const selectedDate = datePicker.value;
            const records = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
            const dailyRecord = records[selectedDate] || {};
            
            const cellIndex = Array.from(document.querySelectorAll('.interactive-cell')).indexOf(cell);
            textarea.value = dailyRecord.notes ? (dailyRecord.notes[cellIndex] || '') : '';
            
            modal.style.display = 'flex';
            textarea.focus();
        }

        function closeNoteModal() {
            document.getElementById('noteModal').style.display = 'none';
            currentCell = null;
        }

        function saveNote() {
            const textarea = document.getElementById('noteTextarea');
            const note = textarea.value.trim();
            const datePicker = document.getElementById('datePicker');
            const selectedDate = datePicker.value;
            
            if (!selectedDate) {
                showAlert('提示', '请先选择日期');
                return;
            }
            
            const records = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
            const dailyRecord = records[selectedDate] || {};
            
            if (!dailyRecord.notes) {
                dailyRecord.notes = [];
            }
            
            const cellIndex = Array.from(document.querySelectorAll('.interactive-cell')).indexOf(currentCell);
            dailyRecord.notes[cellIndex] = note;
            
            if (note) {
                currentCell.classList.add('has-note');
            } else {
                currentCell.classList.remove('has-note');
            }
            
            records[selectedDate] = dailyRecord;
            localStorage.setItem(STORAGE_KEY, JSON.stringify(records));
            
            closeNoteModal();
        }

        function loadDailyRecord() {
            const datePicker = document.getElementById('datePicker');
            const selectedDate = datePicker.value;
            
            if (!selectedDate) return;
            
            const records = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
            const dailyRecord = records[selectedDate];
            
            if (dailyRecord) {
                const cells = document.querySelectorAll('.interactive-cell');
                if (Array.isArray(dailyRecord)) {
                    cells.forEach((cell, index) => {
                        if (dailyRecord[index]) {
                            cell.classList.add('checked');
                        } else {
                            cell.classList.remove('checked');
                        }
                        cell.classList.remove('has-note');
                    });
                } else {
                    if (dailyRecord.checkedStates) {
                        cells.forEach((cell, index) => {
                            if (dailyRecord.checkedStates[index]) {
                                cell.classList.add('checked');
                            } else {
                                cell.classList.remove('checked');
                            }
                        });
                    }
                    
                    if (dailyRecord.notes) {
                        cells.forEach((cell, index) => {
                            if (dailyRecord.notes[index]) {
                                cell.classList.add('has-note');
                            } else {
                                cell.classList.remove('has-note');
                            }
                        });
                    }
                }
            } else {
                document.querySelectorAll('.interactive-cell').forEach(cell => {
                    cell.classList.remove('checked');
                    cell.classList.remove('has-note');
                });
            }
        }

        function saveDailyRecord() {
            const datePicker = document.getElementById('datePicker');
            const selectedDate = datePicker.value;
            
            if (!selectedDate) return;
            
            const records = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
            let dailyRecord = records[selectedDate] || {};
            
            const checkedStates = [];
            document.querySelectorAll('.interactive-cell').forEach(cell => {
                checkedStates.push(cell.classList.contains('checked'));
            });
            dailyRecord.checkedStates = checkedStates;
            
            if (!dailyRecord.notes) {
                dailyRecord.notes = [];
            }
            
            records[selectedDate] = dailyRecord;
            localStorage.setItem(STORAGE_KEY, JSON.stringify(records));
        }

        function formatDate(dateString) {
            const date = new Date(dateString);
            return `${date.getMonth() + 1}月${date.getDate()}日`;
        }

        function initDatePicker() {
            const datePicker = document.getElementById('datePicker');
            const now = new Date();
            const currentYear = now.getFullYear();
            
            const minDate = new Date(currentYear, 6, 1);
            const maxDate = new Date(currentYear, 8, 0);
            
            datePicker.min = formatDateForInput(minDate);
            datePicker.max = formatDateForInput(maxDate);
            
            if (now >= minDate && now <= maxDate) {
                datePicker.valueAsDate = now;
            } else {
                datePicker.valueAsDate = minDate;
            }
            
            disableWeekends(datePicker);
            loadDailyRecord();
        }

        function formatDateForInput(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            return `${year}-${month}-${day}`;
        }

        function disableWeekends(datePicker) {
            datePicker.addEventListener('input', function() {
                const selectedDate = new Date(this.value);
                const dayOfWeek = selectedDate.getDay();
                
                if (dayOfWeek === 0 || dayOfWeek === 6) {
                    showAlert('提示', '周末不可选择，请选择工作日', function() {
                        this.value = '';
                    }.bind(this));
                }
            });
        }

        function showAlert(title, message, confirmCallback, cancelCallback) {
            const alertBox = document.getElementById('customAlert');
            const alertTitle = document.getElementById('alertTitle');
            const alertMessage = document.getElementById('alertMessage');
            const confirmBtn = document.getElementById('alertConfirmBtn');
            const cancelBtn = document.getElementById('alertCancelBtn');
            
            alertTitle.textContent = title;
            alertMessage.textContent = message;
            alertBox.style.display = 'flex';
            
            confirmBtn.onclick = function() {
                alertBox.style.display = 'none';
                if (confirmCallback) confirmCallback();
            };
            
            cancelBtn.onclick = function() {
                alertBox.style.display = 'none';
                if (cancelCallback) cancelCallback();
            };
        }

        function clearTodayRecord() {
            const datePicker = document.getElementById('datePicker');
            const selectedDate = datePicker.value;
            
            if (!selectedDate) {
                showAlert('提示', '请先选择日期');
                return;
            }
            
            showAlert('确认', '确定要清除当日的所有记录吗？此操作不可撤销！', function() {
                const records = JSON.parse(localStorage.getItem(STORAGE_KEY) || '{}');
                delete records[selectedDate];
                localStorage.setItem(STORAGE_KEY, JSON.stringify(records));
                
                loadDailyRecord();
                showAlert('成功', '当日记录已清除');
            });
        }

        function clearAllRecords() {
            showAlert('确认', '确定要清除所有记录吗？此操作不可撤销！', function() {
                localStorage.removeItem(STORAGE_KEY);
                showAlert('成功', '所有记录已清除');
                loadDailyRecord();
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            initDatePicker();
        });
    </script>
</body>
</html>
